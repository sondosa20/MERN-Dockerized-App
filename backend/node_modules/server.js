const express = require('express');  //Framework pour creer des serveurs web en Node.js
const mongoose = require('mongoose'); //librairie pour interagir avec la base de données MongoDB
const userRoutes = require('./routes/users');
require('dotenv').config();  //changement les variables d'environnement dans un fichier .env

const app = express();  // Initialisation de l'application Express
const PORT = process.env.PORT || 5000;  //500 port par defaut

app.use(express.json()); // Middleware(entre client et serveur) pour analyser les corps de requêtes JSON
app.use('/api/users', userRoutes);

// Connexion à la base de données MongoDB
mongoose.connect(process.env.MONGO_URI, {  //connect methode asynchrone avec promesse
  useNewUrlParser: true,
  useUnifiedTopology: true,
})
.then(() => console.log('MongoDB connected'))  //si la promesse est resolue
.catch((err) => console.error('MongoDB connection error:', err)); //si la promesse est rejetée

//demarrage du serveur
app.listen(PORT, () => console.log(`Server running on port ${PORT}`));
